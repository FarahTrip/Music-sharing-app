@model Trippin_Website.ViewModels.User_Content_ViewModel


@using Microsoft.AspNet.Identity;

<style>
    #ProfilePic {
        height: 250px;
        width: 250px;
        background-size: contain;
        border-radius: 50%;
        margin-top: 20px;
        margin-bottom: 10px;
    }

    .Profile-wrapper {
        margin-top: 50px;
        background-color: #0d1117;
        border-radius: 15px;
    }

    .file-input {
        margin-top: 20px;
    }

    .submit-button-container {
        margin-top: 10px;
    }

    .form-message {
        margin-top: 5px;
        font-size: 14px;
        color: red;
    }

    .delete-profile-picture {
        margin-top: 10px;
        display: block;
        color: red;
        font-size: 14px;
    }

    .owner-message {
        margin-top: 20px;
        font-size: 18px;
        color: green;
    }

    .not-owner-message {
        margin-top: 20px;
        font-size: 18px;
        color: red;
    }

    .user-name {
        margin-top: 10px;
        font-size: 24px;
        font-weight: bold;
    }

    .user-id {
        margin-top: 5px;
        font-size: 14px;
        color: #999;
    }

    .file-upload {
        position: relative;
        display: inline-block;
    }

    .file-upload-button {
        background-color: #2196f3;
        color: #fff;
        border: none;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

        .file-upload-button:hover {
            background-color: #0d47a1;
        }

    #file-input {
        position: absolute;
        left: -9999px;
    }

    .dark-theme .file-upload-button {
        background-color: #444;
        color: #fff;
    }

        .dark-theme .file-upload-button:hover {
            background-color: #222;
        }

    .file-input input[type="file"] {
        display: none;
    }

    .Profile-wrapper {
        margin-top: 50px;
        background-color: #0d1117;
        color: #fff;
        padding: 20px;
    }

        .Profile-wrapper h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }

    .song-card-container {
        display: flex;
        flex-wrap: wrap;
        margin-bottom: 20px;
    }

    .song-card {
        color: #fff;
        border-radius: 10px;
        padding: 20px;
        margin-right: 20px;
        margin-bottom: 20px;
        width: calc(33.33% - 20px);
        transition: transform 0.3s ease-in-out;
        background-color: rgba(52,68,92, 20);
    }

        .song-card:hover {
            transform: translateY(-5px);
            box-shadow: 0px 2px 10px rgba(0, 0, 0, 0.3);
            background-color: rgba(52,68,92,1);
        }

        .song-card h2 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .song-card ul { 
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .song-card li {
            font-size: 14px;
            margin-bottom: 5px;
        }

            .song-card li strong {
                font-weight: bold;
                margin-right: 5px;
            }

        .song-card.is-banger {
            background-color: #c53030;
        }

            .song-card.is-banger h2 {
                color: #fff;
            }

            

            .song-card.is-banger .song-info {
                border-top: 1px solid #fff;
                margin-top: 10px;
                padding-top: 10px;
            }

    #show-more-btn {
        background-color: #3182ce;
        color: #fff;
        border: none;
        border-radius: 5px;
        padding: 10px;
        font-size: 16px;
        cursor: pointer;
    }

        #show-more-btn:hover {
            background-color: #2c5282;
        }

    .song-card {
        background-color: #34445C;
        border-radius: 15px;
        color: #fff;
        display: flex;
        flex-direction: column;
        margin-bottom: 20px;
        padding: 20px;
    }

    .details {
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        margin-top: 20px;
    }

        .details p {
            margin-right: 20px;
        }

    #show-more-button {
        background-color: #0d1117;
        border: none;
        border-radius: 5px;
        color: #fff;
        cursor: pointer;
        font-size: 18px;
        margin-top: 20px;
        padding: 10px;
        transition: background-color 0.3s ease-in-out;
    }

        #show-more-button:hover {
            background-color: #262c3a;
        }
</style>

@{

    ViewBag.Title = "Profile";
    Layout = "~/Views/Shared/_Layout.cshtml";

}




<div class="Profile-wrapper text-center">
    @if (Model.User.ProfilePicture != null)
    {
        <img id="ProfilePic" src="~/Content/Images/User Profiles Images/@Model.User.ProfilePicture" alt="Alternate Text" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; object-position: center;">
    }
    else
    {
        <img id="ProfilePic" src="~/Content/Images/No-profile-picture.jpg" alt="Alternate Text" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; object-position: center;">
    }

    @if (Model.User.Id == User.Identity.GetUserId())
    {
        if (Model.User.ProfilePicture == null)
        {
            using (Html.BeginForm("UploadProfilePicture", "Upload", FormMethod.Post, new { enctype = "multipart/form-data", id = "profile-picture-form" }))
            {
                <div class="file-upload">
                    <input type="file" id="file-input" name="file" onchange="document.getElementById('profile-picture-form').submit();" />
                    <label for="file-input" class="file-upload-button">
                        Incarca
                    </label>
                </div>
                <div class="submit-button-container">
                    <p class="form-message">@ViewBag.Message</p>
                </div>
            }
        }
        else
        {
            <a href="@Url.Action("DeleteProfilePicture", "UsersManagement")" class="delete-profile-picture">Sterge poza</a>
        }

        <h2 class="user-name">@Model.User.UserName</h2>
        <p class="user-id">@Model.User.Id</p>

        <h4 class="owner-message">Esti cel care detine acest cont</h4>
    }
    else
    {
        <h2 class="user-name">@Model.User.UserName</h2>
        <p class="user-id">@Model.User.Id</p>
        <h4 class="not-owner-message">Nu esti cel care detine acest cont!</h4>
    }



</div>

<div class="Profile-wrapper text-center">
    <h1>Piesele lui @Model.User.UserName </h1>
    <div class="song-card-container">
        @foreach (var piesa in Model.Piese.Where(c => c.UserId == Model.User.Id))
        {
            <div class="song-card" id="@piesa.Id">
                <h2> <a href="@Url.Action("Detalii", "Piese", new {id = piesa.Id})">@piesa.Name</a></h2>
                <div class="details">
                    <p><strong>Key:</strong> @piesa.Key</p>
                    <p><strong>Bpm:</strong> @piesa.Bpm</p>
                    <p><strong>Date Created:</strong> @piesa.DateCreated.ToString("d")</p>
                    @if (piesa.DateModified.HasValue)
                    {
                        <p><strong>Date Modified:</strong> @piesa.DateModified.Value.ToString("d")</p>
                    }
                    <p><strong>Is Banger:</strong> @piesa.IsBanger</p>
                </div>
            </div>
        }
    </div>
    <button id="show-more-btn">Arata tot</button>
</div>

<script>
    const songs = document.querySelectorAll('.song-card');
    const button = document.getElementById('show-more-btn');
    let currentCount = 3;

    songs.forEach((song, index) => {
        if (index > currentCount - 1) {
            song.style.display = 'none';
        }
    });

    button.addEventListener('click', () => {
        currentCount += 3;

        songs.forEach((song, index) => {
            if (index < currentCount) {
                song.style.display = 'block';
            } else {
                song.style.display = 'none';
            }
        });

        if (currentCount >= songs.length) {
            button.style.display = 'none';
        }
    });
</script>

